#!/bin/sh

#
# http://en.wikibooks.org/wiki/Clojure_Programming/Getting_Started#Enhancing_the_Environment
#

breakchars="(){}[],^%$#@\"\";:''|\\"
CRITERIUM_JAR="/Users/reborg/.m2/repository/criterium/criterium/0.4.4/criterium-0.4.4.jar"
NODISASSEMBLE_JAR="/Users/reborg/.m2/repository/nodisassemble/nodisassemble/0.1.3/nodisassemble-0.1.3.jar"

# CLOJURE_JAR="/Users/reborg/.m2/repository/org/clojure/clojure/1.9.0-cachasm/clojure-1.9.0-cachasm.jar"
CLOJURE_JAR="/Users/reborg/.m2/repository/org/clojure/clojure/1.9.0-master-SNAPSHOT/clojure-1.9.0-master-SNAPSHOT.jar"
# CLOJURE_JAR="/Users/reborg/.m2/repository/org/clojure/clojure/1.8.0/clojure-1.8.0.jar"

# CLOJURE_JAR="/home/reborg/.m2/repository/org/clojure/clojure/1.9.0-alpha5/clojure-1.9.0-alpha5.jar"
# CLOJURE_JAR="/Users/reborg/.m2/repository/org/clojure/clojure/1.3.0/clojure-1.3.0.jar"
# CLOJURE_JAR="/Users/reborg/prj/3rdparties/clojure/target/clojure-1.8.0-master-SNAPSHOT.jar"
# CLOJURE_JAR="/Users/reborg/.m2/repository/org/clojure/clojure/1.7.0/clojure-1.7.0.jar"
# CLOJURE_JAR="/Users/reborg/Downloads/clojure-1.6.0.jar"

if [ $# -eq 0 ]; then
exec rlwrap --remember -c -b "$breakchars" \
       -f "$HOME"/.clj_completions \
       java -cp "$CLOJURE_JAR:$CRITERIUM_JAR:$NODISASSEMBLE_JAR" clojure.main
       else
       exec java -cp "$CLOJURE_JAR" clojure.main $1 -- "$@"
       fi

# Use the following to generate the completion file:
# exec java -cp "$CLOJURE_JAR:$CRITERIUM_JAR" clojure.main
# (def completions (keys (ns-publics (find-ns 'clojure.core)))) (with-open [f (java.io.BufferedWriter. (java.io.FileWriter. (str (System/getenv "HOME") "/.clj_completions")))] (.write f (apply str (interpose \newline completions))))
